#!/bin/bash

exists() {
  which "$1" >/dev/null 2>&1
}

if ! exists setxkbmap ; then
    echo "Can't find setxkbmap." 2>&1
    exit -1
fi

if ! exists xscreensaver-command ; then
    echo "Can't find xscreensaver-command." 2>&1
    exit -1
fi

setxkbmap -layout us

LAYOUT=/tmp/.layout
if [ -p "$LAYOUT" ]; then
    echo "en" >"$LAYOUT" &
fi

setxkbmap -layout us,ru
xscreensaver-command -lock >/dev/null 2>&1 && exit
